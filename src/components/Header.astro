---
const { active = "home" } = Astro.props;

const navLinks = [
  { id: "features", href: "/features", label: "Features" },
  { id: "pricing", href: "/pricing", label: "Pricing" },
  { id: "faq", href: "/faq", label: "FAQ" },
];

const linkBase = "block px-2 py-1 hover:text-slate-50 transition";
const linkActive = "text-slate-50";
---

<header id="site-header" class="sticky top-0 z-50 backdrop-blur-md bg-slate-950/80 border-b border-slate-800/60">

  <!-- TOP BAR -->
  <div class="mx-auto max-w-6xl px-4 py-4 flex items-center justify-between">
    <!-- Logo -->
    <div class="flex items-center gap-2">
      <div class="h-8 w-8 rounded-xl bg-gradient-to-br from-indigo-400 via-sky-400 to-violet-500 flex items-center justify-center text-slate-950 font-bold text-lg">
        P
      </div>
      <a href="/" class="font-semibold tracking-tight text-slate-50">PulseStack</a>
    </div>

    <!-- Desktop nav -->
    <nav class="hidden md:flex items-center gap-8 text-sm text-slate-300">
      {navLinks.map((link) => (
        <a
          href={link.href}
          class={`${linkBase} ${active === link.id ? linkActive : ""}`}
        >
          {link.label}
        </a>
      ))}
      <a
        href="/pricing"
        class="ml-2 rounded-full bg-indigo-500 px-4 py-1.5 text-slate-950 font-medium hover:bg-indigo-400 transition"
      >
        Start free trial
      </a>
    </nav>

    <!-- Mobile hamburger (animates to X) -->
    <button
      type="button"
      class="md:hidden inline-flex items-center justify-center rounded-full border border-slate-700 w-9 h-9 text-xs text-slate-200 relative"
      aria-label="Toggle menu"
      aria-expanded="false"
      data-mobile-menu-toggle
      data-open="false"
    >
      <span class="hamburger-bar bar-top" aria-hidden="true"></span>
      <span class="hamburger-bar bar-middle" aria-hidden="true"></span>
      <span class="hamburger-bar bar-bottom" aria-hidden="true"></span>
    </button>
  </div>

  <!-- MOBILE MENU + BACKDROP WRAPPER -->
  <div class="relative w-full md:hidden">
    <!-- Dropdown menu -->
    <div
      id="mobile-menu"
      class="
        border-t border-slate-800 bg-slate-950/98
        max-h-0 overflow-hidden opacity-0 scale-95 pointer-events-none
        shadow-xl shadow-slate-950/70
        transition-all duration-[500ms] ease-[cubic-bezier(0.22,1,0.36,1)]
        z-50 relative
      "
    >
      <nav class="px-4 py-4 text-sm text-slate-300 space-y-2">
        {navLinks.map((link) => (
          <a
            href={link.href}
            class={`${linkBase} ${active === link.id ? linkActive : ""}`}
          >
            {link.label}
          </a>
        ))}
        <a
          href="/pricing"
          class="
            mt-3 inline-flex w-full items-center justify-center
            rounded-full bg-indigo-500 px-4 py-2 text-sm font-medium text-slate-950
            hover:bg-indigo-400 transition
          "
        >
          Start free trial
        </a>
      </nav>
    </div>

    <!-- Backdrop starts BELOW menu (blur + dim) -->
    <div
      id="mobile-backdrop"
      class="
        fixed inset-x-0 bottom-0
        opacity-0 pointer-events-none
        bg-slate-900/60 backdrop-blur-md
        transition-opacity duration-[500ms] ease-out
        z-[40]
      "
      style="top: 0;"
    ></div>
  </div>

  <script>
    if (typeof window !== "undefined") {
      window.addEventListener("DOMContentLoaded", () => {
        const toggle = document.querySelector("[data-mobile-menu-toggle]");
        const menu = document.getElementById("mobile-menu");
        const backdrop = document.getElementById("mobile-backdrop");
        if (!toggle || !menu || !backdrop) return;

        let open = false;

        const updateBackdropPosition = () => {
          const rect = menu.getBoundingClientRect();
          backdrop.style.top = rect.bottom + "px";
        };

        const setOpen = (isOpen) => {
          open = isOpen;
		  document.body.style.overflow = open ? "hidden" : "auto";

          menu.classList.toggle("max-h-0", !open);
          menu.classList.toggle("opacity-0", !open);
          menu.classList.toggle("scale-95", !open);
          menu.classList.toggle("pointer-events-none", !open);

          menu.classList.toggle("max-h-96", open);
          menu.classList.toggle("opacity-100", open);
          menu.classList.toggle("scale-100", open);
          menu.classList.toggle("pointer-events-auto", open);

          backdrop.classList.toggle("opacity-0", !open);
          backdrop.classList.toggle("pointer-events-none", !open);
          backdrop.classList.toggle("opacity-100", open);

          toggle.setAttribute("data-open", open ? "true" : "false");
          toggle.setAttribute("aria-expanded", open ? "true" : "false");

          if (open) updateBackdropPosition();
        };

        toggle.addEventListener("click", () => setOpen(!open));
        backdrop.addEventListener("click", () => open && setOpen(false));
        window.addEventListener("resize", () => open && updateBackdropPosition());
      });
    }
  </script>

  <style>
	/* Force hamburger + mobile UI to be hidden on desktop */
    @media (min-width: 768px) {
      button[data-mobile-menu-toggle],
      #mobile-menu,
      #mobile-backdrop {
        display: none !important;
      }
    }
  
    /* Hamburger icon â†’ X */
    button[data-mobile-menu-toggle] {
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .hamburger-bar {
      position: absolute;
      left: 50%;
      width: 18px;
      height: 2px;
      border-radius: 999px;
      background-color: rgb(226 232 240); /* slate-200 */
      transform: translateX(-50%);
      transform-origin: center;
      transition:
        transform 220ms cubic-bezier(0.22, 1, 0.36, 1),
        opacity 160ms ease-out;
    }

    .bar-top {
      top: 9px;
    }

    .bar-middle {
      top: 15px;
    }

    .bar-bottom {
      top: 21px;
    }

    button[data-mobile-menu-toggle][data-open="true"] .bar-top {
      transform: translate(-50%, 6px) rotate(45deg);
    }

    button[data-mobile-menu-toggle][data-open="true"] .bar-middle {
      opacity: 0;
      transform: translateX(-50%) scaleX(0.6);
    }

    button[data-mobile-menu-toggle][data-open="true"] .bar-bottom {
      transform: translate(-50%, -6px) rotate(-45deg);
    }
	
	header#site-header {
	  box-shadow: 0 2px 12px rgba(0,0,0,.25);
	}
	
	section { padding-block: 6rem; }
	@media (min-width: 768px) {
	  section { padding-block: 8rem; }
	}
	
	a.btn {
	  transition: transform .2s, box-shadow .2s;
	}
	a.btn:hover {
	  transform: translateY(-2px) scale(1.02);
	  box-shadow: 0 4px 12px rgba(0,0,0,.4);
	}



  </style>
</header>
